echo "🔍 Ejecutando validaciones previas al commit..."

# Validación de ESLint
echo "⚙️ Verificando código con ESLint..."
npx next lint
if [ $? -ne 0 ]; then
  echo "❌ ESLint encontró problemas en el código."
  exit 1
fi
echo "✅ ESLint no encontró problemas."

# Validación de Prettier
echo "⚙️ Verificando formato con Prettier..."
npx prettier --check .
if [ $? -ne 0 ]; then
  echo "❌ Prettier detectó problemas de formato en algunos archivos."
  echo "💡 Solución sugerida: Ejecuta el comando 'npm run format' para corregir automáticamente los problemas."
  echo "¿Quieres ejecutar 'npm run format' ahora? (s/n)"
  
  # Leer entrada del usuario
  read -r respuesta
  if [ "$respuesta" = "s" ]; then
    echo "🚀 Ejecutando 'npm run format'..."
    npm run format
    echo "✅ Problemas corregidos automáticamente. Por favor, realiza el commit nuevamente."
  else
    echo "⚠️ No se aplicaron correcciones. Por favor, corrige los problemas manualmente antes de realizar el commit."
    exit 1
  fi
fi

echo "✅ El formato del código es correcto."
echo "🎉 ¡Todos los chequeos pasaron! Procediendo con el commit..."
